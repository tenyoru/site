@use "sass:map";
@use "sass:string";
@use "colors" as c;

// Emit CSS variables from a theme map
@mixin emit-theme-vars($theme-map) {
  @each $k, $v in $theme-map {
    --#{$k}: #{$v};
  }
}

// Convenience: read a CSS var in SCSS
@function theme($key) {
  @return string.unquote("var(--#{$key})");
}

// Default theme + prepare UA color-scheme hint
:root {
  @include emit-theme-vars(map.get(c.$themes, c.$default-theme));
  @if c.$default-theme == light {
    color-scheme: light;
  } @else {
    color-scheme: dark;
  }
}

// Generate [data-theme="name"] blocks for each theme
@each $name, $map in c.$themes {
  :root[data-theme="#{$name}"] {
    @include emit-theme-vars($map);
    @if $name == light {
      color-scheme: light;
    } @else {
      color-scheme: dark;
    }
  }
}

// Optional: smoother switch
.theme-transition * {
  transition: background-color .2s ease, color .2s ease, border-color .2s ease;
}
