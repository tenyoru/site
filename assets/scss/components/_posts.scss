@use "../theme" as *;
@use "./code" as code;

@mixin tag-pill {
  $tag-bg: color-mix(in srgb, theme(card) 85%, theme(bg) 15%);
  $tag-border: color-mix(in srgb, theme(border) 55%, transparent);
  $tag-color: color-mix(in srgb, theme(text) 70%, theme(bg) 30%);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.18rem 0.75rem;
  border-radius: 999px;
  border: 1px solid $tag-border;
  background-color: $tag-bg;
  font-size: 0.72rem;
  letter-spacing: 0.06em;
  text-decoration: none;
  color: $tag-color;
  transition: color 0.2s ease, border-color 0.2s ease, background-color 0.2s ease;
}

@mixin tag-pill-hover {
  $tag-hover-bg: color-mix(in srgb, theme(card) 75%, theme(accent) 25%);
  $tag-hover-border: color-mix(in srgb, theme(accent) 40%, theme(border) 60%);
  &:hover,
  &:focus-visible {
    color: theme(accent);
    border-color: $tag-hover-border;
    background-color: $tag-hover-bg;
    outline: none;
    text-decoration: none;
  }
}

.section-head {
  margin-block-end: clamp(1rem, 4vw, 2.5rem);
  text-align: left;
}

.section-head--center {
  text-align: center;
}

.section-head--center .section-title-row {
  justify-content: center;
}

.section-head--center .section-intro {
  margin-inline: auto;
}

.section-tags-wrapper {
  margin-block-start: 0.85rem;
  text-align: left;
}

.section-head--center .section-tags-wrapper {
  text-align: center;
}

.section-tags-wrapper .section-tags {
  display: inline-flex;
}

.section-title {
  font-size: clamp(2rem, 4vw, 2.75rem);
  margin: 0;
  color: var(--text-highlight);
}

.section-title-row {
  display: flex;
  align-items: baseline;
  gap: 0.4rem;
  flex-wrap: wrap;
}

.section-rss {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.15rem;
  color: theme(accent);
  text-decoration: none;
  line-height: 1;
  border-radius: 0.35rem;
  transition: color 0.2s ease, background-color 0.2s ease;
}

.section-rss:hover,
.section-rss:focus-visible {
  color: theme(link-hover);
  background-color: color-mix(in srgb, theme(accent) 12%, transparent);
  outline: none;
}

.section-rss .rss-icon {
  width: 1.4rem;
  height: 1.4rem;
  stroke: currentColor;
  fill: none;
}

.section-tags {
  @include tag-pill;
  font-size: 0.78rem;
  padding-inline: 0.95rem;
  @include tag-pill-hover;
}

.section-intro {
  margin-block-start: 0.75rem;
  max-width: clamp(32ch, 60vw, 60ch);
  font-size: 1rem;
  line-height: 1.6;
  opacity: 0.85;
}

.post-grid {
  display: flex;
  flex-direction: column;
  gap: clamp(1rem, 2vw, 1.5rem);
}

.post-card {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  background: color-mix(in srgb, theme(bg) 85%, theme(card) 15%);
  border: 1px solid color-mix(in srgb, theme(border) 75%, transparent);
  border-radius: 1rem;
  box-shadow: 0 0.6rem 1.5rem color-mix(in srgb, theme(shadow) 8%, transparent);
  overflow: hidden;
  padding: clamp(1rem, 3vw, 1.35rem);
  color: inherit;
  text-decoration: none;
  cursor: pointer;
  outline: none;
  transition: box-shadow 0.2s ease, transform 0.2s ease;
  user-select: none;
}

.post-card:focus-visible {
  box-shadow: 0 0 0 2px color-mix(in srgb, theme(accent) 40%, transparent), 0 0.6rem 1.5rem color-mix(in srgb, theme(shadow) 12%, transparent);
}

.post-card:hover {
  box-shadow: 0 1rem 2.25rem color-mix(in srgb, theme(shadow) 15%, transparent);
  transform: translateY(-3px);
}

.post-card__head {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  justify-content: space-between;
  gap: 0.35rem 0.75rem;
}

.post-card__title {
  margin: 0;
  font-size: clamp(1.15rem, 3vw, 1.45rem);
  line-height: 1.25;
  color: var(--text-heading);
}

.post-card__title-link {
  color: inherit;
  text-decoration: none;
}

.post-card__title-link:hover,
.post-card__title-link:focus-visible {
  color: var(--text-highlight);
  text-decoration: none;
}

.post-card__date {
  font-size: 0.9rem;
  color: var(--text-subtle);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.post-card__date time {
  font-variant-numeric: tabular-nums;
}

.post-card__excerpt {
  margin: 0;
  color: color-mix(in srgb, var(--text-base) 85%, var(--bg) 15%);
  line-height: 1.55;
}

.post-card__tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem;
  margin: 0 0 0.3rem;
  padding: 0;
  list-style: none;
}

.post-card__tags li {
  margin: 0;
}

.post-card__tag {
  @include tag-pill;
  @include tag-pill-hover;
}

@media (max-width: 640px) {
  .post-card__head {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.35rem;
  }

  .post-card__date {
    order: 0;
    width: 100%;
  }
}

.term-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.65rem;
}

.term-list li {
  list-style: none;
}

.term-list__link {
  @include tag-pill;
  @include tag-pill-hover;
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
  padding-inline: 0.95rem;
  text-decoration: none;
}

.term-list__name {
  font-weight: 600;
  font-size: 0.85rem;
}

.term-list__count {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: color-mix(in srgb, theme(text) 55%, theme(bg) 45%);
}

.term-back {
  margin-top: clamp(1.5rem, 5vw, 2.5rem);
}

.term-back__link {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.6rem 1.2rem;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, theme(border) 75%, transparent);
  background-color: color-mix(in srgb, theme(bg) 85%, theme(card) 15%);
  box-shadow: 0 0.6rem 1.5rem color-mix(in srgb, theme(shadow) 8%, transparent);
  color: color-mix(in srgb, theme(text) 92%, theme(bg) 8%);
  text-decoration: none;
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.term-back__link:hover,
.term-back__link:focus-visible {
  color: theme(accent);
  border-color: color-mix(in srgb, theme(accent) 35%, theme(border) 65%);
}

.term-back__icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.1rem;
  height: 1.1rem;
  color: inherit;
}
.term-back__icon .arrow-left-icon {
  width: 1rem;
  height: 1rem;
}

.post-pagination {
  margin-block: clamp(2rem, 5vw, 3rem);
}

.post-empty {
  color: color-mix(in srgb, theme(text) 70%, theme(bg) 30%);
  text-align: center;
}

.post {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.post-column {
  width: 100%;
  max-width: clamp(60ch, 80vw, 70ch);
  margin-inline: auto;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}
.post-header {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  padding-bottom: 1.25rem;
  margin-bottom: 1.2rem;
  border-bottom: 1px solid color-mix(in srgb, theme(border) 60%, transparent);
}

.post-meta {
  display: flex;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
  font-size: 0.78rem;
  letter-spacing: 0.04em;
  color: color-mix(in srgb, theme(text) 55%, theme(bg) 45%);
}

.post-date {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  font-size: inherit;
  color: inherit;
}

.post-date time {
  font-variant-numeric: tabular-nums;
}

.post-readtime {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  font-size: inherit;
  text-transform: none;
  letter-spacing: inherit;
  color: inherit;
}

.post-readtime span {
  display: inline-block;
}

.clock-icon,
.date-icon {
  width: 0.8rem;
  height: 0.8rem;
  flex-shrink: 0;
  color: color-mix(in srgb, theme(text) 45%, theme(bg) 55%);
}

.clock-icon {
  fill: none;
  stroke: currentColor;
  stroke-width: 1.5;
}

.date-icon {
  fill: none;
  stroke: currentColor;
  stroke-width: 1.5;
}

.post-tags {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.4rem;
  margin-top: 0;
  margin-bottom: 0.1rem;
}

.post-tags__label {
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: color-mix(in srgb, theme(text) 60%, theme(bg) 40%);
}

.post-tags__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
}

.post-tags__list a {
  @include tag-pill;
  @include tag-pill-hover;
}

.post-description {
  margin-top: 0.85rem;
  font-size: 1rem;
  line-height: 1.6;
  color: color-mix(in srgb, theme(text) 80%, theme(bg) 20%);
}

.post-toc {
  margin: 0.75rem 0 0.5rem;
  padding: 0.65rem 0.85rem;
  border-left: 2px solid color-mix(in srgb, theme(accent) 30%, theme(border) 70%);
  border-radius: 0.4rem;
  background: color-mix(in srgb, theme(bg) 97%, theme(card) 3%);
  font-size: 0.9rem;
}

.post-toc__summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.75rem;
  color: color-mix(in srgb, theme(text) 60%, theme(bg) 40%);
  cursor: pointer;
  list-style: none;
  padding: 0.2rem 0;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
}

.post-toc__summary::-webkit-details-marker {
  display: none;
}

.post-toc__chevron {
  width: 0.45rem;
  height: 0.45rem;
  border-right: 2px solid currentColor;
  border-bottom: 2px solid currentColor;
  transform: rotate(45deg);
  transition: transform 0.2s ease;
}

.post-toc[open] .post-toc__chevron {
  transform: rotate(-135deg);
}

.post-toc__body {
  margin-top: 0.75rem;
}

.post-toc__body ul {
  list-style: none;
  padding-left: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
}

.post-toc__body li {
  line-height: 1.4;
}

.post-toc__body a {
  color: color-mix(in srgb, theme(text) 90%, theme(bg) 10%);
  text-decoration: none;
}

.post-toc__body a:hover,
.post-toc__body a:focus-visible {
  color: theme(accent);
  outline: none;
}

.post-toc__body ul ul {
  padding-left: 1rem;
  margin-top: 0.3rem;
  border-left: 1px solid color-mix(in srgb, theme(border) 70%, transparent);
}

.post-content {
  width: 100%;
  margin: 0 auto;
  line-height: 1.75;
  color: color-mix(in srgb, theme(text) 90%, theme(bg) 10%);
}

.post-content > :first-child {
  margin-top: 0;
}

.post-content > * {
  margin-top: 1.5rem;
  margin-bottom: 0;
}

.post-content p,
.post-content ul,
.post-content ol {
  margin-top: 1rem;
}

.post-content h2,
.post-content h3 {
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.post-content h2:first-of-type,
.post-content h3:first-of-type {
  margin-top: 1.5rem;
}

.post-content ul,
.post-content ol {
  padding-inline-start: 1.25rem;
  list-style-position: outside;
}

.post-comments {
  margin-top: clamp(1.5rem, 4vw, 2.5rem);
}

.post-content img,
.post-content video,
.post-content iframe {
  border-radius: 0.75rem;
  margin: 1.5rem auto;
  width: 100%;
  height: auto;
  display: block;
}
