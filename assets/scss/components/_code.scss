@use "../theme" as *;

$code-bg: color-mix(in srgb, theme(card) 65%, theme(bg) 35%);
$code-border: color-mix(in srgb, theme(border) 60%, transparent);
$code-color: theme(code);
$code-padding: 1rem 1.25rem;
$scrollbar-track: color-mix(in srgb, theme(bg) 70%, theme(card) 30%);
$scrollbar-thumb: color-mix(in srgb, theme(border) 40%, theme(text) 60%);
$scrollbar-thumb-hover: color-mix(in srgb, theme(accent) 40%, theme(text) 60%);

@mixin code-scrollbars {
  scrollbar-width: thin;
  scrollbar-color: #{$scrollbar-thumb} #{$scrollbar-track};
  scrollbar-gutter: stable both-edges;

  &::-webkit-scrollbar {
    height: 1rem;
    width: 1rem;
  }

  &::-webkit-scrollbar:horizontal {
    height: 1rem;
  }

  &::-webkit-scrollbar:vertical {
    width: 1rem;
  }

  &::-webkit-scrollbar-track {
    background: $scrollbar-track;
    border-radius: 999px;
  }

  &::-webkit-scrollbar-thumb {
    background: $scrollbar-thumb;
    border-radius: 999px;
    border: 1px solid color-mix(in srgb, theme(text) 15%, transparent);
  }

  &::-webkit-scrollbar-thumb:hover {
    background: $scrollbar-thumb-hover;
  }

  &::-webkit-scrollbar-corner {
    background: $scrollbar-track;
  }
}

.highlight,
pre:not(.chroma) {
  max-width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
  white-space: pre;
  border-radius: 0.9rem;
  background: $code-bg;
  border: 1px solid $code-border;
  color: $code-color;
  padding: $code-padding;
  box-shadow: 0 10px 30px color-mix(in srgb, theme(shadow) 10%, transparent);
  font-size: 0.95rem;
  line-height: 1.55;
  font-family: "JetBrains Mono", "Fira Code", "SFMono-Regular", Menlo, Consolas, "Liberation Mono", monospace;
  @include code-scrollbars;
}

.highlight {
  padding: 0;
}

.highlight pre {
  margin: 0;
  padding: $code-padding;
  @include code-scrollbars;
}

:not(pre) > code {
  font-size: 0.9rem;
  line-height: 1.5;
  background: $code-bg;
  color: $code-color;
  padding: 0.15rem 0.4rem;
  border-radius: 0.35rem;
  border: 1px solid $code-border;
  font-family: "JetBrains Mono", "Fira Code", "SFMono-Regular", Menlo, Consolas, "Liberation Mono", monospace;
}

.highlight code,
pre code {
  background: transparent;
  border: 0;
  padding: 0;
  color: inherit;
  font-size: inherit;
  line-height: inherit;
}
