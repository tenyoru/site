{{ define "main" }}
<div class="contact shell--narrow">
  {{ $siteContact := .Site.Params.contact }}
  {{ $hero := .Params.hero }}
  {{ if not $hero }}
    {{ with $siteContact }}
      {{ with .hero }}{{ $hero = . }}{{ end }}
    {{ end }}
  {{ end }}

  <header class="contact-header">
    <h1 class="contact-header__title">{{ .Title }}</h1>
    {{ with $hero }}
      {{ with .body }}
      <p class="contact-header__desc">{{ . | markdownify | plainify }}</p>
      {{ end }}
    {{ end }}
  </header>

  {{ $contacts := .Params.contacts }}
  {{ if not $contacts }}
    {{ with $siteContact }}
      {{ with .contacts }}{{ $contacts = . }}{{ end }}
    {{ end }}
  {{ end }}

  {{ with $contacts }}
    {{ with .items }}
    <ul class="contact-list">
      {{ range . }}
      {{ $value := .value | default .url }}
      {{ $url := .url }}
      {{ $isExternal := or (strings.HasPrefix $url "http") (strings.HasPrefix $url "//") }}
      <li class="contact-item">
        {{ if $url }}
        <a href="{{ $url | safeURL }}" class="contact-item__link"{{ if $isExternal }} target="_blank" rel="noopener noreferrer"{{ end }}>
          {{ with .icon }}
          <span class="contact-item__icon">{{ partial "svg.html" . }}</span>
          {{ end }}
          <span class="contact-item__info">
            {{ with .label }}<span class="label">{{ . }}</span>{{ end }}
            <span class="contact-item__value">{{ $value }}</span>
          </span>
        </a>
        {{ else }}
        <div class="contact-item__static">
          {{ with .icon }}
          <span class="contact-item__icon">{{ partial "svg.html" . }}</span>
          {{ end }}
          <span class="contact-item__info">
            {{ with .label }}<span class="label">{{ . }}</span>{{ end }}
            <span class="contact-item__value">{{ $value }}</span>
          </span>
        </div>
        {{ end }}
      </li>
      {{ end }}
    </ul>
    {{ end }}
  {{ end }}

  {{ with .Content }}
  <div class="contact-extra">{{ . }}</div>
  {{ end }}
</div>
{{ end }}
